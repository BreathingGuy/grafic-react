import { useEffect } from 'react';

import { useMetaStore } from './store/metaStore';
import { useDateStore } from './store/dateStore';
import { useAdminStore } from './store/adminStore';

import UserView from './components/Views/UserView';
import AdminView from './components/Views/AdminView';

/**
 * Main - –∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
 * –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
 */
function Main() {
  const isAdminMode = useAdminStore(state => state.isAdminMode);

  useEffect(() => {
    console.log('üü¢ App initialization started');

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º dateStore (–≤—ã—á–∏—Å–ª–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç)
    useDateStore.getState().initialize();
    console.log('üìÖ DateStore initialized');

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤
    useMetaStore.getState().loadDepartmentsList();
    console.log('üè¢ Departments list loading...');
  }, []);

  // –ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏
  return isAdminMode ? <AdminView /> : <UserView />;
}

export default function App() {
  return <Main />;
}
